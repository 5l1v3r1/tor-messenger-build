# HG changeset patch
# User Sebastian Hengst <archaeopteryx@coole-files.de>
# Date 1428083489 -7200
#      Fri Apr 03 19:51:29 2015 +0200
# Node ID f2e7cea9bc6aca3140fb49512d4cc16f85988540
# Parent  1cc7a71a04355c949421c3789386c48af37f5f3b
Bug 1150967 - Port Bug 1147839 - Fix building installer on mingw by only including helper.exe if mknsisu is used. r=clokep,mkmelin,Neil a=Ratty for SeaMonkey CLOSED TREE

diff -r 1cc7a71a0435 -r f2e7cea9bc6a im/installer/Makefile.in
--- a/im/installer/Makefile.in	Thu Apr 02 19:46:06 2015 +0200
+++ b/im/installer/Makefile.in	Fri Apr 03 19:51:29 2015 +0200
@@ -93,6 +93,10 @@
 DEFINES += -DMOZ_PURPLE
 endif
 
+ifdef MAKENSISU
+DEFINES += -DHAVE_MAKENSISU=1
+endif
+
 ifdef MOZ_PKG_MANIFEST_P
 MOZ_PKG_MANIFEST = package-manifest
 
diff -r 1cc7a71a0435 -r f2e7cea9bc6a im/installer/package-manifest.in
--- a/im/installer/package-manifest.in	Thu Apr 02 19:46:06 2015 +0200
+++ b/im/installer/package-manifest.in	Fri Apr 03 19:51:29 2015 +0200
@@ -52,7 +52,7 @@
 @RESPATH@/searchplugins/*
 @RESPATH@/dictionaries/*
 @RESPATH@/hyphenation/*
-#ifdef XP_WIN32
+#ifdef HAVE_MAKENSISU
 @BINPATH@/uninstall/helper.exe
 #endif
 #ifdef MOZ_UPDATER
diff -r 1cc7a71a0435 -r f2e7cea9bc6a mail/installer/Makefile.in
--- a/mail/installer/Makefile.in	Thu Apr 02 19:46:06 2015 +0200
+++ b/mail/installer/Makefile.in	Fri Apr 03 19:51:29 2015 +0200
@@ -87,6 +87,10 @@
 DEFINES += -DMOZ_SHARED_MOZGLUE=1
 endif
 
+ifdef MAKENSISU
+DEFINES += -DHAVE_MAKENSISU=1
+endif
+
 ifdef MOZ_PKG_MANIFEST_P
 MOZ_PKG_MANIFEST = package-manifest
 
diff -r 1cc7a71a0435 -r f2e7cea9bc6a mail/installer/package-manifest.in
--- a/mail/installer/package-manifest.in	Thu Apr 02 19:46:06 2015 +0200
+++ b/mail/installer/package-manifest.in	Fri Apr 03 19:51:29 2015 +0200
@@ -53,7 +53,7 @@
 @RESPATH@/searchplugins/*
 @RESPATH@/dictionaries/*
 @RESPATH@/hyphenation/*
-#ifdef XP_WIN32
+#ifdef HAVE_MAKENSISU
 @BINPATH@/uninstall/helper.exe
 #endif
 #ifdef MOZ_UPDATER
diff -r 1cc7a71a0435 -r f2e7cea9bc6a suite/installer/Makefile.in
--- a/suite/installer/Makefile.in	Thu Apr 02 19:46:06 2015 +0200
+++ b/suite/installer/Makefile.in	Fri Apr 03 19:51:29 2015 +0200
@@ -121,6 +121,10 @@
 
 DEFINES += -DMOZ_CHILD_PROCESS_NAME=$(MOZ_CHILD_PROCESS_NAME)
 
+ifdef MAKENSISU
+DEFINES += -DHAVE_MAKENSISU=1
+endif
+
 ifdef MOZ_PKG_MANIFEST_P
 MOZ_PKG_MANIFEST = package-manifest
 
diff -r 1cc7a71a0435 -r f2e7cea9bc6a suite/installer/package-manifest.in
--- a/suite/installer/package-manifest.in	Thu Apr 02 19:46:06 2015 +0200
+++ b/suite/installer/package-manifest.in	Fri Apr 03 19:51:29 2015 +0200
@@ -54,7 +54,7 @@
 @RESPATH@/hyphenation/*
 @RESPATH@/@PREF_DIR@/suite-l10n.js
 @RESPATH@/searchplugins/*
-#ifdef XP_WIN32
+#ifdef HAVE_MAKENSISU
 @BINPATH@/uninstall/helper.exe
 #endif
 #ifdef MOZ_UPDATER
